
<link rel="stylesheet" type="text/css" href="/stylesheets/profilecss.css" >

<body>
  <section class="h-100 gradient-custom  p-4">

    <div class="container-fluid py-5" >
      <div class="row">
        <div class="col-xl-4 order-xl-2 mb-5 mb-xl-0" >
          <div class="card card-profile shadow">
              <div class="row justify-content-center">
              <div class="col-lg-3 order-lg-2">
                <div class="card-profile-image">
                  <a href="#">
                    <img src="/images/prof.jpg" class="rounded-circle">
                  </a>
                </div>
              </div>
            </div>
      
            <div class="card-body pt-8 pt-md-4">
              <div class="row ">
                <div class="col">
                  <div class="card-profile-stats d-flex justify-content-center mt-md-5">
                    <div>
                      <span class="heading">Hello, {{singleUser.name}}</span>

                    </div>
                  </div>
                </div>
                 <div class="col-12">
                  <div class="ms-5" >
                     <a href="/wallet" style="color: rgb(73, 66, 66);"><i class="fa-solid fa-wallet fs-2"></i> <span class="fs-4">Wallet</span> </a> 
                  </div>
                </div>
              </div>
              <div class="text-center">
               <div class="h5 mt-4 border border-1 p-2">
                  <a href="/view-orders" class="prof"><span class="fs-4"> My Orders</span></a>
                </div>
                <div class="h5  border border-1 p-2" >
                  <h3>ReferralCode</h3>
                  <span class="h3" id="referral">{{referralCode}}</span>
                  <button class="text-success btn fs-6" onclick="copyText()">copy</button><br>
                  <span class="fw-bold">Refer & Get â‚¹100</span>
                </div>
                <hr>
                <div class="h5 mt-4">
                  <a href="/change-password"> <span class="fs-4">Change Password</span></a>
                </div>
                <div class="h5 mt-4 ">
                  <a href="/userlogout" class="btn fs-6"> 
                    <i class="fa-solid fa-power-off fs-5"></i><span class="fs-4 w-100"> Logout</span>
                    </a>

                </div>
              
              </div>
            </div>
          </div>
        </div>
        <div class="col-xl-8 order-xl-1">
          <div class="card bg-secondary shadow">
         
            <div class="card-header bg-white border-0">
              <div class="row align-items-center">
                <div class="col-sm-6">
                  <h2 class="mb-0">Manage Addresses</h2>
                </div>
       
              </div>
            </div>

            <div class="card-body d-flex justify-content-center">
                <div class="pl-lg-4 col-12">
                  <div class="row" id="addbtn" style="display: block;">
                    <div class="col-lg-6 mb-3 mt-3 border border-1 p-2 bg-primary text-white " style="cursor: pointer;" onclick="addressup()">
                        <i class="fa-solid fa-plus"></i> <span class="fs-5">Add a new address</span>
                    </div>
                  </div>
                  <div class="row" id="bigdiv" style="background-color: rgb(192, 225, 247); display: none;">
                    <form action="/manage-addresses" method="post">
                   <div class="row ">
                    
                        <div class="col-lg-6 mb-3 mt-3">
                          <div class="form-group focused">
                        <label class="form-control-label fs-5" for="name">Name</label>
                        <input type="text" id="name" class="form-control form-control-alternative" name="name" 
                        placeholder="Full name" value="" required>
                      </div>
                    </div>
 
                    <div class="col-lg-6 mb-3 mt-3">
                      <div class="form-group focused">
                        <label class="form-control-label fs-5" for="mobilenumber">Mobile number</label>
                        <input type="text" id="mobilenumber" class="form-control form-control-alternative" name="phone" 
                        placeholder="mobile number" value="" pattern="(7|8|9)\d{9}$" 
                        title="Enter a valid phone number,must be a 10 digit number" required>
                      </div>
                    </div>
                    <div class="col-lg-6 mb-3 ">
                      <div class="form-group">
                        <label class="form-control-label fs-5" for="input-email">Email address</label>
                        <input type="email" id="input-email" class="form-control form-control-alternative" name="email" 
                        placeholder="email address" value="" required>
                      </div>
                    </div>
                    <div class="col-lg-6 mb-3 ">
                      <div class="form-group focused">
                        <label class="form-control-label fs-5" for="input-address">Address</label>
                        <input type="text" id="input-address" class="form-control form-control-alternative" name="address" 
                        placeholder="Home Address" value="" required>
                      </div>
                    </div>
                    <div class="col-lg-6 mb-5">
                      <div class="form-group focused">
                        <label class="form-control-label fs-5" for="state">State</label>
                        <input type="text" id="state" class="form-control form-control-alternative" name="state" 
                        placeholder="state" value="" required>
                      </div>
                    </div>
                    <div class="col-lg-6 mb-5">
                      <div class="form-group focused">
                        <label class="form-control-label fs-5" for="pincode">Postal code</label>
                        <input type="text" id="pincode" class="form-control form-control-alternative" name="pincode"
                         placeholder="pincode" value="" pattern="\d{6}" 
                        title="Enter 6 digit valid pincode"  required>
                      </div>
                    </div>
                   
                   <div class="col-lg-12 d-flex justify-content-center mb-2">
                    <button type="submit" id="save" class="btn  btn-info fs-6 w-25" >ADD</button> 
                    <button type="button" id="" onclick="closediv()" class="btn bg-white fs-6 ms-2" >cancel</button>
                   </div>
                    
                    
                   
                  </div>
                </form>
                  </div>
                     
                    <div class="row">
                        {{#each addresses}}
                        <div class="col-12 border border-1 border-dark p-2 mt-3 mb-2 p-3" id="editdiv{{this.id}}" style="display: block;" >
                               <p><span class="fs-6 fw-bold">{{this.name}}</span><span class="fs-6 fw-bold ms-4">{{this.mobile}}</span>
                               <button class="btn float-right fs-5 Btns" onclick="removeAddress('{{this.id}}','{{this.name}}')"><i class="fa fa-trash" aria-hidden="true"></i></button>
                               <button class="btn float-right fs-5 Btns" onclick="editUp('{{this.id}}')" ><i class="fa-solid fa-pen-to-square"></i></button>
                               </p>
                               <p><span>{{this.address}}</span></p>
                               <p><span>{{this.state}}</span><span class="ms-3">{{this.pincode}}</span></p>
                        </div>


                  <div class="row" id="BigEditForm{{this.id}}" style="background-color: rgb(188, 207, 182); display: none;">
                    <form action="/edit-Address" method="post">
                   <div class="row ">

                        <div class="col-lg-6 mb-3 mt-3">
                          <div class="form-group focused">
                        <label class="form-control-label fs-5" for="name">Name</label>
                        <input type="text" name="id" value="{{this.id}}" hidden>
                        <input type="text" id="name" class="form-control form-control-alternative" name="name" 
                        placeholder="Full name" value="{{this.name}}" required>
                      </div>
                    </div>
 
                    <div class="col-lg-6 mb-3 mt-3">
                      <div class="form-group focused">
                        <label class="form-control-label fs-5" for="mobilenumber">Mobile number</label>
                        <input type="text" id="mobilenumber" class="form-control form-control-alternative" name="phone" 
                        placeholder="mobile number" value="{{this.mobile}}" pattern="(7|8|9)\d{9}$" 
                        title="Enter a valid phone number,must be a 10 digit number" required>
                      </div>
                    </div>
                    <div class="col-lg-6 mb-3 ">
                      <div class="form-group">
                        <label class="form-control-label fs-5" for="input-email">Email address</label>
                        <input type="email" id="input-email" class="form-control form-control-alternative" name="email" 
                        placeholder="email address" value="{{this.email}}" required>
                      </div>
                    </div>
                    <div class="col-lg-6 mb-3 ">
                      <div class="form-group focused">
                        <label class="form-control-label fs-5" for="input-address">Address</label>
                        <input type="text" id="input-address" class="form-control form-control-alternative" name="address" 
                        placeholder="Home Address" value="{{this.address}}" required>
                      </div>
                    </div>
                    <div class="col-lg-6 mb-5">
                      <div class="form-group focused">
                        <label class="form-control-label fs-5" for="state">State</label>
                        <input type="text" id="state" class="form-control form-control-alternative" name="state" 
                        placeholder="state" value="{{this.state}}" required>
                      </div>
                    </div>
                    <div class="col-lg-6 mb-5">
                      <div class="form-group focused">
                        <label class="form-control-label fs-5" for="pincode">Postal code</label>
                        <input type="text" id="pincode" class="form-control form-control-alternative" name="pincode"
                         placeholder="pincode" value="{{this.pincode}}" pattern="\d{6}" 
                        title="Enter 6 digit valid pincode"  required>
                      </div>
                    </div>
                   
                   <div class="col-lg-12 d-flex justify-content-center mb-2">
                    <button type="submit" class="btn  btn-info fs-6 w-25" >SAVE</button> 
                    <button type="button" onclick="closeEditForm('{{this.id}}')" class="btn bg-white fs-6 ms-2">cancel</button>
                   </div>
                  </div>
                  </form>
                  </div>
                  {{/each}}
                       
                   </div>
                 

                </div>

                </div>

            </div>
          </div>
        </div>
      </div>

  </section>

<script>
    function addressup(){
        document.getElementById('addbtn').style.display='none'
        document.getElementById('bigdiv').style.display='block'
        $(".Btns").prop("disabled", true);
    }
    function closediv(){
        document.getElementById('addbtn').style.display='block'
        document.getElementById('bigdiv').style.display='none'
        $(".Btns").prop("disabled", false);
    }

    function editUp(addressId){
      document.getElementById("editdiv"+addressId).style.display="none"
      document.getElementById("BigEditForm"+addressId).style.display="block" 
      $(".Btns").prop("disabled", true);
      document.getElementById('addbtn').style.display='none'
      
    }

    function closeEditForm(addressId){
      document.getElementById("editdiv"+addressId).style.display="block"
      document.getElementById("BigEditForm"+addressId).style.display="none"  
      $(".Btns").prop("disabled", false);
     document.getElementById('addbtn').style.display='block'
    }


  

      function removeAddress(addressId,name){
      Swal.fire({
        title: 'Are you want to delete '+name,
        text: "You won't be able to revert this!",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'Yes, delete it!'
      }).then((result) => {
      if (result.isConfirmed) {
        $.ajax({
          url:'/remove-address',
          data:{
            address:addressId
          },
          method:'post',
          success:(response)=>{
            location.reload()
          }
        })
      }else{
        
      }
    })

}
</script>
</body>
